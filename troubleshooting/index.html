<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Notify and take action on server updates via MQTT, with HomeAssistant compatibility"><link href=https://updates2mqtt.rhizomatics.org.uk/troubleshooting/ rel=canonical><link href=../local_builds/ rel=prev><link href=../configuration/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.3"><title>Troubleshooting - Updates2MQTT</title><link rel=stylesheet href=../assets/stylesheets/main.484c7ddc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../assets/mkdocs_pagetree_plugin.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#troubleshooting class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title=Updates2MQTT class="md-header__button md-logo" aria-label=Updates2MQTT data-md-component=logo> <img src=../images/updates2mqtt-dark-256x256.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Updates2MQTT </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Troubleshooting </span> </div> </div> </div> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/rhizomatics/updates2mqtt title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> rhizomatics/updates2mqtt </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../changelog/ class=md-tabs__link> What's New </a> </li> <li class=md-tabs__item> <a href=../home_assistant/ class=md-tabs__link> HomeAssistant Integration </a> </li> <li class=md-tabs__item> <a href=../installation/ class=md-tabs__link> Installation </a> </li> <li class=md-tabs__item> <a href=../local_builds/ class=md-tabs__link> Local Builds </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=./ class=md-tabs__link> Troubleshooting </a> </li> <li class=md-tabs__item> <a href=../configuration/ class=md-tabs__link> Configuration </a> </li> <li class=md-tabs__item> <a href=../developer/coverage/ class=md-tabs__link> Developer </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title=Updates2MQTT class="md-nav__button md-logo" aria-label=Updates2MQTT data-md-component=logo> <img src=../images/updates2mqtt-dark-256x256.png alt=logo> </a> Updates2MQTT </label> <div class=md-nav__source> <a href=https://github.com/rhizomatics/updates2mqtt title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> rhizomatics/updates2mqtt </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class=md-nav__item> <a href=../changelog/ class=md-nav__link> <span class=md-ellipsis> What's New </span> </a> </li> <li class=md-nav__item> <a href=../home_assistant/ class=md-nav__link> <span class=md-ellipsis> HomeAssistant Integration </span> </a> </li> <li class=md-nav__item> <a href=../installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../local_builds/ class=md-nav__link> <span class=md-ellipsis> Local Builds </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Troubleshooting </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#general class=md-nav__link> <span class=md-ellipsis> General </span> </a> </li> <li class=md-nav__item> <a href=#updates2mqtt-logs class=md-nav__link> <span class=md-ellipsis> Updates2MQTT Logs </span> </a> <nav class=md-nav aria-label="Updates2MQTT Logs"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#changing-log-level class=md-nav__link> <span class=md-ellipsis> Changing Log Level </span> </a> </li> <li class=md-nav__item> <a href=#going-inside-container class=md-nav__link> <span class=md-ellipsis> Going Inside Container </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mqtt class=md-nav__link> <span class=md-ellipsis> MQTT </span> </a> <nav class=md-nav aria-label=MQTT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mqtt-clients class=md-nav__link> <span class=md-ellipsis> MQTT Clients </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#home-assistant class=md-nav__link> <span class=md-ellipsis> Home Assistant </span> </a> <nav class=md-nav aria-label="Home Assistant"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#checklist class=md-nav__link> <span class=md-ellipsis> Checklist </span> </a> <nav class=md-nav aria-label=Checklist> <ul class=md-nav__list> <li class=md-nav__item> <a href=#home-assistant-mosquitto-hassos-app class=md-nav__link> <span class=md-ellipsis> Home Assistant Mosquitto HassOS App </span> </a> </li> <li class=md-nav__item> <a href=#alternative-mqtt-discovery class=md-nav__link> <span class=md-ellipsis> Alternative MQTT Discovery </span> </a> </li> <li class=md-nav__item> <a href=#no-update-button class=md-nav__link> <span class=md-ellipsis> No Update Button </span> </a> </li> <li class=md-nav__item> <a href=#home-assistant-logs class=md-nav__link> <span class=md-ellipsis> Home Assistant Logs </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#docker class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> <nav class=md-nav aria-label=Docker> <ul class=md-nav__list> <li class=md-nav__item> <a href=#docker-help class=md-nav__link> <span class=md-ellipsis> Docker Help </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#registry-api class=md-nav__link> <span class=md-ellipsis> Registry API </span> </a> </li> <li class=md-nav__item> <a href=#too-many-requests class=md-nav__link> <span class=md-ellipsis> Too Many Requests </span> </a> </li> <li class=md-nav__item> <a href=#docker-cli class=md-nav__link> <span class=md-ellipsis> Docker CLI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../configuration/ class="md-nav__link "> <span class=md-ellipsis> Configuration </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../configuration/customizing_containers/ class=md-nav__link> <span class=md-ellipsis> Customizing Containers </span> </a> </li> <li class=md-nav__item> <a href=../configuration/remote_api_usage/ class=md-nav__link> <span class=md-ellipsis> Remote API Usage </span> </a> </li> <li class=md-nav__item> <a href=../configuration/security/ class=md-nav__link> <span class=md-ellipsis> Improving Security </span> </a> </li> <li class=md-nav__item> <a href=../configuration/using_a_config_file/ class=md-nav__link> <span class=md-ellipsis> Using A Configuration File </span> </a> </li> <li class=md-nav__item> <a href=../configuration/zero_config_file/ class=md-nav__link> <span class=md-ellipsis> Without a Configuration File </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7_7> <div class="md-nav__link md-nav__container"> <a href=../configuration/examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> <label class="md-nav__link " for=__nav_7_7 id=__nav_7_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7_7> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../configuration/examples/config_maximal/ class=md-nav__link> <span class=md-ellipsis> Maximal Configuration </span> </a> </li> <li class=md-nav__item> <a href=../configuration/examples/config_minimal/ class=md-nav__link> <span class=md-ellipsis> Minimal Configuration </span> </a> </li> <li class=md-nav__item> <a href=../configuration/examples/docker_compose/ class=md-nav__link> <span class=md-ellipsis> Docker Compose </span> </a> </li> <li class=md-nav__item> <a href=../configuration/examples/env/ class=md-nav__link> <span class=md-ellipsis> Environment File </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_8> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex=0> <span class=md-ellipsis> Developer </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Developer </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../developer/coverage/ class=md-nav__link> <span class=md-ellipsis> Coverage </span> </a> </li> <li class=md-nav__item> <a href=../developer/oci_container/ class=md-nav__link> <span class=md-ellipsis> Understanding Container Metadata </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/rhizomatics/updates2mqtt/edit/main/docs/troubleshooting.md title="Edit this page" class="md-content__button md-icon" rel=edit> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg> </a> <a href=https://github.com/rhizomatics/updates2mqtt/raw/main/docs/troubleshooting.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg> </a> <h1 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h1> <h2 id=general>General<a class=headerlink href=#general title="Permanent link">&para;</a></h2> <p>Things that need to work:</p> <ul> <li>Docker API access to list and inspect containers</li> <li>MQTT Publication of results</li> <li>Home Assistant discovering the Update entities on MQTT</li> <li>Home Assistant generating update notices in UI when there&rsquo;s a new version</li> <li>Command Topic message sent by Home Assistant when Update button clicked</li> <li>Docker Compose available from shell to make updates and restart</li> <li>Git command available in shell to check for local repo updates and pull</li> </ul> <h2 id=updates2mqtt-logs>Updates2MQTT Logs<a class=headerlink href=#updates2mqtt-logs title="Permanent link">&para;</a></h2> <p>If running under docker, and following the container naming guidance, then see the logs using:</p> <p><code>docker logs updates2mqtt</code></p> <p>or change to the directory where the <code>docker-compose.yaml</code> is installed and do <code>docker compose logs</code></p> <h3 id=changing-log-level>Changing Log Level<a class=headerlink href=#changing-log-level title="Permanent link">&para;</a></h3> <p>Update the <code>config.yaml</code> and change the log level to DEBUG, which will show much more diagnostic information.</p> <div class="language-yaml highlight"><span class=filename>conf/config.yaml</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nt>log</span><span class=p>:</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>  </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG</span>
</span></code></pre></div> <p>When you have everything working, its best to change the log level back, so your container isn&rsquo;t generating big logs.</p> <h3 id=going-inside-container>Going Inside Container<a class=headerlink href=#going-inside-container title="Permanent link">&para;</a></h3> <p>From the <code>docker-compose.yaml</code> directory, execute </p> <p><code>docker compose exec -it updates2mqtt bash</code></p> <p>(if you have an old Docker install, you may need to use <code>docker-compose</code> instead of <code>docker compose</code>)</p> <p>This will give you shell access inside the container, which is a good way of checking for path issues, permissio issues etc. For example, if you have compose directories in the <code>/containers</code> directory, you could <code>cd /containers</code> and validate that Updates2MQTT can see the other compose directories, <code>ls</code> the contents, and run <code>docker compose</code> or <code>git</code> actions there.</p> <h2 id=mqtt>MQTT<a class=headerlink href=#mqtt title="Permanent link">&para;</a></h2> <p>If the host, port, user and password for MQTT are incorrect then usually this will show in the logs, or use a MQTT client to verify that Updates2MQTT is successfully posting to topics ( and that HomeAssistant itself is publishing to the same broker OK).</p> <p>Updates2MQTT uses the <a href=https://github.com/eclipse-paho/paho.mqtt.python>Eclipse Paho Python Client</a> for all MQTT interaction, using v2 of the callback API, and supports the older MQTT implementations as well as the newer v5 protocol. The <a href="https://github.com/eclipse-paho/paho.mqtt.python/issues?q=is%3Aissue">Issues</a> list might give you some clues for your situation. </p> <h3 id=mqtt-clients>MQTT Clients<a class=headerlink href=#mqtt-clients title="Permanent link">&para;</a></h3> <p>Use a desktop MQTT app - <a href=https://mqttx.app>MQTTX</a> will let you subscribe to <code>#</code> and see everything on a broker, while <a href=https://mqtt-explorer.com>MQTT Explorer</a> automatically shows a tree structure of topics, and can run either as a desktop app, or as <a href=https://github.com/Smeagolworms4/MQTT-Explorer>web app running on Docker</a>.</p> <p>These tools will let you inspect messages, and also publish your own, so can create your own update message and see if it gets picked up by the Home Assistant app.</p> <p>Alternatively, use the debug option and logging of Mosquitto broker, or the built-in admin/debug UI of EMQX broker. Or the handy command line <code>mosquitto_sub</code> and <code>mosquitto_pub</code>, which are also used by the Updates2MQTT health check.</p> <h2 id=home-assistant>Home Assistant<a class=headerlink href=#home-assistant title="Permanent link">&para;</a></h2> <h3 id=checklist>Checklist<a class=headerlink href=#checklist title="Permanent link">&para;</a></h3> <p>(All of these can be checked and changed via the Home Assistant UI.)</p> <ul> <li>HA is configured with an MQTT integration</li> <li>MQTT broker host and port is the same on HA as Updates2MQTT<ul> <li>Updates2MQTT has been tested with Mosquitto and EMQX</li> </ul> </li> <li>Automatic <em>Discovery</em> is on</li> <li>The discovery prefix matches Updates2MQTT ( they both default to <code>homeassistant</code>)</li> </ul> <p>See the examples at <a href=../home_assistant/#configuration>Home Assistant Configuration</a></p> <p>In addition to the base MQTT configuration, Updates2MQTT relies on <a href=https://www.home-assistant.io/integrations/update.mqtt/ >MQTT Discovery</a> and <a href=https://www.home-assistant.io/integrations/update.mqtt/ >MQTT Update</a> integrations. All of these have a single set of <a href="https://github.com/home-assistant/core/issues?q=is%3Aissue+label%3A%22integration%3A+mqtt%22">MQTT Issues</a>. </p> <p>When configured, each monitored container will have an <code>update</code> entity visible in the <a href=https://www.home-assistant.io/docs/tools/dev-tools/ >Home Assistant Developer Tools</a> and <a href=https://www.home-assistant.io/docs/configuration/entities_domains/ >Entities View</a>.</p> <h4 id=home-assistant-mosquitto-hassos-app>Home Assistant Mosquitto HassOS App<a class=headerlink href=#home-assistant-mosquitto-hassos-app title="Permanent link">&para;</a></h4> <p>If using the default <em>Mosquitto</em> broker, and <em>Customization</em> switched on, check the ACL configuration has <code>readwrite</code> access give to the Updates2MQTT user for its topics. The <a href=https://github.com/home-assistant/addons/blob/master/mosquitto/DOCS.md>HomeAssistant add-in config</a> puts this in the <code>/share/mosquitto</code> directory. </p> <p>Oddly, the Paho MQTT client used by Updates2MQTT is known to <a href=https://github.com/eclipse-paho/paho.mqtt.python/issues/895>report success even when broker rejects message because of ACL restrictions</a>.</p> <h4 id=alternative-mqtt-discovery>Alternative MQTT Discovery<a class=headerlink href=#alternative-mqtt-discovery title="Permanent link">&para;</a></h4> <p>There&rsquo;s also an alternative to MQTT Discovery in HA, using plain yaml, the <a href=https://www.home-assistant.io/integrations/update.mqtt/#configuration>MQTT Update Integration</a>. The <a href=https://bbqkees-electronics.nl/wiki/home-automations/home-assistant-configuration.html>BBQKees Boiler Gateway</a> has some detailed steps and examples for MQTT Discovery too.</p> <h4 id=no-update-button>No Update Button<a class=headerlink href=#no-update-button title="Permanent link">&para;</a></h4> <p>If there&rsquo;s an update showing, but no <em>Update</em> button present, then there&rsquo;s a few reasons, which can be checked directly from the config and log:</p> <ul> <li>Config has the <code>allow_pull</code>,<code>allow_restart</code> and <code>allow_build</code> all overridden to <code>False</code></li> <li>A new version reference can&rsquo;t be found </li> <li>The compose working directory can&rsquo;t be found</li> <li>This is sourced from the <code>com.docker.compose.project.working_dir</code> label, which can be seen in <code>docker inspect</code></li> <li>This only stops restart, not pull, so if <code>allow_pull</code> is on, the Update button will still show</li> <li>The git repo path can&rsquo;t be found for a local build</li> </ul> <p>The current state of this can be seen in MQTT, the config message will have two extra values as below:</p> <div class="language-json highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=w>  </span><span class=nt>&quot;command_topic&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;updates2mqtt/dockernuc/docker&quot;</span><span class=p>,</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=w>  </span><span class=nt>&quot;payload_install&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;docker|homarr|install&quot;</span>
</span></code></pre></div> <h4 id=home-assistant-logs>Home Assistant Logs<a class=headerlink href=#home-assistant-logs title="Permanent link">&para;</a></h4> <p>Use the <a href=https://www.home-assistant.io/integrations/system_log/ >System Log</a> to check for MQTT errors, or for positive confirmation that Update entities have been discovered. The <em>raw</em> log will show more, and allow you to scroll back for hours.</p> <p>The <a href=https://www.home-assistant.io/integrations/logger/#viewing-logs>Logger Integration</a> lets you tweak the levels of specific integrations. This is less useful for Updates2MQTT, since all the work is happening outside of Home Assistant, however it can be useful for general MQTT issues, and the examples in the Home Assistant documentation shows how to tune the MQTT integration.</p> <h2 id=docker>Docker<a class=headerlink href=#docker title="Permanent link">&para;</a></h2> <p>More detailed information on the Docker API and compatibility with Docker engine versions can be found at Docker&rsquo;s own <a href=https://docs.docker.com/reference/api/engine/ >Docker Engine API</a> reference.</p> <p><code>updates2mqtt</code> is designed to run on the same host as the containers, so only needs local Docker daemon access. All it needs for that is the volume mapping as below:</p> <div class="language-yaml highlight"><span class=filename>Example Docker Compose Snippet</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nt>volumes</span><span class=p>:</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock</span>
</span></code></pre></div> <p>Where <code>docker-compose</code> projects are being automatically updated and restarted, one problem can be that earlier versions used a <code>docker-compose</code> command and newer ones use <code>docker compose</code>. There is a <code>v1</code> and <code>v2</code> option in the <a href=../configuration/ >configuration</a> to support this, defaulting to <code>v2</code>.</p> <p>If the <code>updates2mqtt</code> container is not running as root, then ensure that the user is a member of the local <code>docker</code> group. (If it is running as root, then consider moving to a defined user, see <a href=../configuration/security/#running-as-non-root>Running as Non-Root</a>).</p> <h3 id=docker-help>Docker Help<a class=headerlink href=#docker-help title="Permanent link">&para;</a></h3> <p>Best place to start is the <code>docker-py</code> <a href="https://github.com/docker/docker-py/issues?q=is%3Aissue">Issues</a> on GitHub, since this is the primary component inside Updates2MQTT.</p> <p>A simple way of testing if there&rsquo;s a <code>docker-py</code> issue is to load the client directly from python. This example uses <code>uv</code> to avoid changing local Python environment, use <code>pip</code> or other preferred tool to install if you want instead.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>docker<span class=w> </span>python3
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>&gt;&gt;&gt;<span class=w> </span>import<span class=w> </span>docker
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>&gt;&gt;&gt;<span class=w> </span>docker.__version__
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>&gt;&gt;&gt;<span class=w> </span><span class=nv>client</span><span class=w> </span><span class=o>=</span><span class=w> </span>docker.from_env<span class=o>()</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>&gt;&gt;&gt;<span class=w> </span>client.info<span class=o>()[</span><span class=s1>&#39;Containers&#39;</span><span class=o>]</span>
</span></code></pre></div> <p>This should output the version of the <code>docker</code> package, and the total count of local containers if the connection is good. Updates2MQTT uses at least v7.1.0 of <code>docker</code> for Python API.</p> <h2 id=registry-api>Registry API<a class=headerlink href=#registry-api title="Permanent link">&para;</a></h2> <p>Updates2MQTT uses the Docker developed <code>docker-py</code> library for local management, and originally for discovering updates. Now by default it uses the more modern <a href=https://github.com/opencontainers/distribution-spec/blob/main/spec.md>OCI v2 Distribution API</a> that <code>docker.io</code> and other registries have supported for years. </p> <p>The <code>api</code> option in Docker<code>registry</code> config can override this, set to <code>docker_client</code>,<code>oci_v2</code> or <code>disabled</code>.</p> <p>The OCI APIs require more network calls, typically one to retrieve a token, one for the image index, which points to the platform specific manifest, and finally the config document. On the other hand, well-developer images also provide annotations on these documents, which allow for direct links to release notes and source code, descriptions, semantic versions and more.</p> <p>Registries usually have an unauthenticated token system for authorization, this can be overridden per container using the <code>updates2mqtt.registry_token</code> container label or <code>UPD2MQTT_REGISTRY_TOKEN</code> environment variable.</p> <p>If the benefits of the extra calls ( release summaries, direct release note URLs, human friendly version numbers ), then the additional fetches can be skipped by using <code>OCI_V2_MINIMAL</code> as the <code>api</code> value in the registry configuration section.</p> <div class="admonition tip"> <p class=admonition-title>Tip</p> </div> <p>Images built on GitHub often use the <code>docker-metadata</code> action to create the annotations, which is documented at <a href=https://github.com/docker/metadata-action>metadata-action</a></p> <h2 id=too-many-requests>Too Many Requests<a class=headerlink href=#too-many-requests title="Permanent link">&para;</a></h2> <p>The Docker Registry API has a limit on how many authenticated requests, and a lower limit for unauthenticated requests, can be made per hour.</p> <p>Access to the API will back off when this is hit, and discovery will wait until a configurable period passed, which can be configured using <code>default_api_backoff</code> in the <code>docker</code> configuration section, with a value in seconds.</p> <p>The throttling is determined per registry, so if Docker is throttling it won&rsquo;t affect <code>gchr.io</code>, private registries or others. They will also throttle if needed, but again the throttle will only affect that specific registry, and other scans will continue.</p> <p>The order of containers scanned is shuffled every time, so if there is a lot of throttling it won&rsquo;t be the same ones every time.</p> <h2 id=docker-cli>Docker CLI<a class=headerlink href=#docker-cli title="Permanent link">&para;</a></h2> <p>There is a very bare bones command line debug tool, that will look up an image in either v1 or v2 APIs and dump everything to console at <code>DEBUG</code> log level, while also retrieving tokens to authorize API access and adapting to Docker Hub, GitHub, GitLab or Codeberg registries.</p> <p>Use the <em>container</em> hash, or a container name if one has been given ( easy to find out either of these with <code>docker ps</code>)</p> <p>There&rsquo;s no need to install Updates2MQTT to use the manifest and blob fetching ability. </p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w> </span><span class=nv>manifest</span><span class=o>=</span>ghcr.io/blakeblackshear/frigate:stable
</span></code></pre></div> <p>The following examples will all work from any Python context, and don&rsquo;t need a local Docker or any Docker access.</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w>  </span><span class=nv>manifest</span><span class=o>=</span>ghcr.io/blakeblackshear/frigate:stable
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w>  </span><span class=nv>blob</span><span class=o>=</span>ghcr.io/blakeblackshear/frigate@sha256:ef8d56a7d50b545af176e950ce328aec7f0b7bc5baebdca189fe661d97924980
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w>  </span><span class=nv>manifest</span><span class=o>=</span>ghcr.io/blakeblackshear/frigate@sha256:c68fd78fd3237c9ba81b5aa927f17b54f46705990f43b4b5d5596cfbbb626af4
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w>  </span><span class=nv>tags</span><span class=o>=</span>ghcr.io/blakeblackshear/frigate
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w>  </span><span class=nv>manifest</span><span class=o>=</span>mcr.microsoft.com/dotnet/sdk:latest
</span></code></pre></div> <p>These examples refer to locally running containers, displaying the local info as well as remote registry</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w>  </span><span class=nv>container</span><span class=o>=</span>frigate
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w> </span><span class=nv>container</span><span class=o>=</span>f4f02e182f5e<span class=w> </span><span class=nv>api</span><span class=o>=</span>docker_client
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>uv<span class=w> </span>run<span class=w> </span>--with<span class=w> </span>updates2mqtt<span class=w> </span>cli<span class=w> </span><span class=nv>container</span><span class=o>=</span>frigate<span class=w> </span><span class=nv>api</span><span class=o>=</span>docker_client<span class=w> </span><span class=nv>log_level</span><span class=o>=</span>DEBUG
</span></code></pre></div> <p>If the package is installed locally then the <code>--with updates2mqtt</code> part can be omitted with uv, or it can be run directly:</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>python<span class=w> </span>updates2mqtt.cli<span class=w> </span><span class=nv>container</span><span class=o>=</span>frigate<span class=w> </span><span class=nv>api</span><span class=o>=</span>docker_client
</span></code></pre></div> <p>Get a dump to CSV rather than MQTT of local Docker containers</p> <div class="language-bash highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>python<span class=w> </span>updates2mqtt.cli<span class=w> </span><span class=nv>dump</span><span class=o>=</span>csv
</span></code></pre></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.code.select", "content.code.annotate", "navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.path", "navigation.indexes", "navigation.top", "toc.follow", "toc.integrate", "search.suggest", "search", "search.share"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../assets/mkdocs_pagetree_plugin.js></script> </body> </html>